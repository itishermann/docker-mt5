version: "3.3"
services:
  mt5:
    container_name: mt5_048
    restart: unless-stopped
    # image: solarkennedy/wine-x11-novnc-docker
    image: gcr.io/ticker-beats/docker-mt5:latest
    ports:
      - "8081:8080"
    environment: 
      WINEPREFIX: "/root/prefix64"
      WINEARCH: win64
    volumes:
      - ./supervisord-kennedy.conf:/etc/supervisor/supervisord.conf
      # - /home/sander/metatrader5/mt5-win-testing-048:/root/metatrader5
      - ../mt5-config/common.ini:/root/prefix64/drive_c/myconfiguration.ini
      # - /home/sander/metatrader5/mt5-win-testing-048-monitor:/root/metatrader5-monitor
      - ../mt5-config/common-monitor.ini:/root/prefix64/drive_c/myconfiguration-monitor.ini

      # MT5, base files, can be read-only
      - /home/sander/metatrader5/docker-mt5-base-files/Chats:/root/metatrader5/Chats:ro
      - /home/sander/metatrader5/docker-mt5-base-files/Market:/root/metatrader5/Market:ro
      - /home/sander/metatrader5/docker-mt5-base-files/Sounds:/root/metatrader5/Sounds:ro
      - /home/sander/metatrader5/docker-mt5-base-files/Tester:/root/metatrader5/Tester:ro
      - /home/sander/metatrader5/docker-mt5-base-files/metaeditor64.exe:/root/metatrader5/metaeditor64.exe:ro
      - /home/sander/metatrader5/docker-mt5-base-files/terminal64.exe:/root/metatrader5/terminal64.exe:ro
      # monitor
      - /home/sander/metatrader5/docker-mt5-base-files/Chats:/root/metatrader5-monitor/Chats:ro
      - /home/sander/metatrader5/docker-mt5-base-files/Market:/root/metatrader5-monitor/Market:ro
      - /home/sander/metatrader5/docker-mt5-base-files/Sounds:/root/metatrader5-monitor/Sounds:ro
      - /home/sander/metatrader5/docker-mt5-base-files/Tester:/root/metatrader5-monitor/Tester:ro
      - /home/sander/metatrader5/docker-mt5-base-files/metaeditor64.exe:/root/metatrader5-monitor/metaeditor64.exe:ro
      - /home/sander/metatrader5/docker-mt5-base-files/terminal64.exe:/root/metatrader5-monitor/terminal64.exe:ro
      # MQL5, base files, can be read-only
      - /home/sander/metatrader5/docker-mql5-base-files/MQL5/Experts:/root/metatrader5/MQL5/Experts:ro
      - /home/sander/metatrader5/docker-mql5-base-files/MQL5/Images:/root/metatrader5/MQL5/Images:ro
      - /home/sander/metatrader5/docker-mql5-base-files/MQL5/Include:/root/metatrader5/MQL5/Include:ro
      - /home/sander/metatrader5/docker-mql5-base-files/MQL5/Indicators:/root/metatrader5/MQL5/Indicators:ro
      - /home/sander/metatrader5/docker-mql5-base-files/MQL5/Libraries:/root/metatrader5/MQL5/Libraries:ro
      - /home/sander/metatrader5/docker-mql5-base-files/MQL5/Scripts:/root/metatrader5/MQL5/Scripts:ro
      - /home/sander/metatrader5/docker-mql5-base-files/MQL5/Services:/root/metatrader5/MQL5/Services:ro
      - "/home/sander/metatrader5/docker-mql5-base-files/MQL5/Shared Projects:/root/metatrader5/MQL5/Shared Projects:ro"
      # monitor
      - /home/sander/metatrader5/docker-mql5-base-files/MQL5/Experts:/root/metatrader5-monitor/MQL5/Experts:ro
      - /home/sander/metatrader5/docker-mql5-base-files/MQL5/Images:/root/metatrader5-monitor/MQL5/Images:ro
      - /home/sander/metatrader5/docker-mql5-base-files/MQL5/Include:/root/metatrader5-monitor/MQL5/Include:ro
      - /home/sander/metatrader5/docker-mql5-base-files/MQL5/Indicators:/root/metatrader5-monitor/MQL5/Indicators:ro
      - /home/sander/metatrader5/docker-mql5-base-files/MQL5/Libraries:/root/metatrader5-monitor/MQL5/Libraries:ro
      - /home/sander/metatrader5/docker-mql5-base-files/MQL5/Scripts:/root/metatrader5-monitor/MQL5/Scripts:ro
      - /home/sander/metatrader5/docker-mql5-base-files/MQL5/Services:/root/metatrader5-monitor/MQL5/Services:ro
      - "/home/sander/metatrader5/docker-mql5-base-files/MQL5/Shared Projects:/root/metatrader5-monitor/MQL5/Shared Projects:ro"


      # MT5, container files
      - /home/sander/metatrader5/mt5-048/Bases:/root/metatrader5/Bases
      - /home/sander/metatrader5/mt5-048/Config:/root/metatrader5/Config
      - /home/sander/metatrader5/mt5-048/Profiles:/root/metatrader5/Profiles
      # monitor
      - /home/sander/metatrader5/mt5-048-monitor/Bases:/root/metatrader5-monitor/Bases
      - /home/sander/metatrader5/mt5-048-monitor/Config:/root/metatrader5-monitor/Config
      - /home/sander/metatrader5/mt5-048-monitor/Profiles:/root/metatrader5-monitor/Profiles
      # MQL5, container files
      - /home/sander/metatrader5/mt5-048/logs:/root/metatrader5/logs
      - /home/sander/metatrader5/mt5-048/MQL5/Logs:/root/metatrader5/MQL5/Logs
      - /home/sander/metatrader5/mt5-048/MQL5/Files:/root/metatrader5/MQL5/Files
      - /home/sander/metatrader5/mt5-048/MQL5/Presets:/root/metatrader5/MQL5/Presets
      - /home/sander/metatrader5/mt5-048/MQL5/Profiles:/root/metatrader5/MQL5/Profiles
      - /home/sander/metatrader5/mt5-048/MQL5/experts.dat:/root/metatrader5/MQL5/experts.dat
      # monitor
      - /home/sander/metatrader5/mt5-048-monitor/logs:/root/metatrader5-monitor/logs
      - /home/sander/metatrader5/mt5-048-monitor/MQL5/Logs:/root/metatrader5-monitor/MQL5/Logs
      - /home/sander/metatrader5/mt5-048-monitor/MQL5/Files:/root/metatrader5-monitor/MQL5/Files
      - /home/sander/metatrader5/mt5-048-monitor/MQL5/Presets:/root/metatrader5-monitor/MQL5/Presets
      - /home/sander/metatrader5/mt5-048-monitor/MQL5/Profiles:/root/metatrader5-monitor/MQL5/Profiles
      - /home/sander/metatrader5/mt5-048-monitor/MQL5/experts.dat:/root/metatrader5-monitor/MQL5/experts.dat
    extra_hosts:
      - "staging.tickerbeats.r6o.co:31.0.10.30"
      - "test.tickerbeats.r6o.co:31.0.10.30"
      - "dev.tickerbeats.r6o.co:31.0.10.30"
      - "prod.tickerbeats.r6o.co:31.0.10.30"
    deploy:
      resources:
        limits:
          cpus: '5'
          memory: 1024M